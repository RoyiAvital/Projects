# SLEEF vs. SVML
Comparison of Run Time between [SLEEF Vectorized Math Library][1] and [Short Vector Math Library][2] (SVML).

## Version  
The current version is `2018_09_24_001`.

## Structure
The project is built on VS 2017 Project with require Intel Compiler 19 for compilation.  
The VS 2017 Solution includes 2 Project:

 1.	EXE File - Which is used to time the different functions.
 2.	DLL File - Which is used to compare the precision.  
 	The comparison is done in MATLAB compared to a reference which is calculated in `Float 64` precision.

## Remarks
 *	The test is using a single thread.
 *	All arrays are AVX Aligned (16 Bytes).
 *	The project is using `Single`  / `Float32` data type.
 *	Each test runs SSE and AVX flavors of the implementation.
 * 	The project is compiled with `/fp:precise`.
 *	SVML has 3 accuracy modes (See [IntelÂ® Math Kernel Library 2018 Vector Mathematics (VM) Performance and Accuracy Data](https://software.intel.com/sites/products/documentation/doclib/mkl/vm/vmdata.htm)):
 	*	High Accuracy (HA) - Error up to 1 [ULP]. Set by `fp:precise`.
 	*	Low Accuracy (LA) - Error up to 4 [ULP]. Set by `fp:fast=1`.
 	*	Enhanced Performance (EP) - Error up to half of the Bits. Set by `fp:fast=2`.  
 *	[Intel Vector Math Library](https://software.intel.com/en-us/mkl-developer-reference-c-vector-mathematical-functions) (VM / VML) is a wrapper around SVML which adds parallelization and dispatching.

## Build
 *	Open the Solution File (`SleefVsSvml.sln`) in Visual Studio 2017.  
 	The projects in the solution are configured to use Intel Compiler 19 (Required for SVML).
 *	Build the project `SleefVsSvml`.
 *	Run the `EXE` file which is the output of t he build using the instructions in *Run*.

## Run
Run the EXE file using `SleefVsSvml.exe <TEST NUMBER> <NUM ELEMENTS> <NUM ITERATIONS> <NEGATIVE VALUES FLAG> <MAX VALUE>`.
Where:

 * 	`TEST NUMBER` - Sets the test to be executed.  
 	Valid Values:
  	*	`1` - Sine Function.
  	*	`3` - Exponent Function.
 *	`NUM ELEMENTS` - Sets the number of `Float32` elements in the array to process. Must be an integer multiplication of 16 (AVX).
 * 	`NUM ITERATIONS` - How many time to process the array to gather statistics of run time.
 * 	`NEGATIVE VALUES FLAG` - Sets whether to generate negative values in the array. `0` to allow only non negative values and `1` to generate negative values.
 * 	`MAX VALUE` - Sets the maximum **absolute** value of the array elements.

For example the following `SleefVsSvml.exe 1 100000000 75 1 50` will run 75 iterations the `sin` function on array with size of 1e8 elements with values of `[-50, 50]`.

The array elements are generated by a random number in the `[0, 1]` range then multiplied by `MAX VALUE` (If `NEGATIVE VALUES FLAG` is `1` then also shifted by half an multiplied by 2).

The project also includes a pre built `EXE` in the ZIP file (Named `SleefVsSvml_2018_09_24_001.zip`).  
The current pre built version is `2018_09_24_001`

## SLEEF
The included is based on SLEEF `3.3.1` compiled using SLEEF's build system with MSVC 2017 with forced `/MT` flag.

## TO DO
 *	Create *CMake* based build system.
 * 	Add more comparison function.
 * 	Support `fp:fast=1` and `fp:fast=2`.
 *	Display results on various systems (Run Time).
 *	Show precision performance compared in MATLAB.

 [1]: https://sleef.org/ "SLEEF Vectorized Math Library"
 [2]: https://software.intel.com/en-us/cpp-compiler-developer-guide-and-reference-intrinsics-for-short-vector-math-library-operations "Intrinsics for Short Vector Math Library Operations"